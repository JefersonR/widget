// Generated by CoffeeScript 1.8.0
(function() {
  var DOMAIN, HEIGHT, WIDTH, attach_element, configure, create_iframe, defaults, document_path, domain_for, getElementById, host_for, origin, protocol_for;

  WIDTH = {
    MIN: 600,
    DEFAULT: 800
  };

  HEIGHT = {
    MIN: 500,
    DEFAULT: 600
  };

  DOMAIN = {
    PROTOCOL: "https",
    HOST: "widget.clicksign.com"
  };

  origin = location.origin;

  getElementById = function(name) {
    return document.getElementById(name);
  };

  defaults = function(d) {
    return function(v) {
      return v || d;
    };
  };

  protocol_for = defaults(DOMAIN.PROTOCOL);

  host_for = defaults(DOMAIN.HOST);

  domain_for = function(p, h) {
    return "" + (protocol_for(p)) + "://" + (host_for(h));
  };

  document_path = function(k, e) {
    return "/documents/" + k + "?email=" + e + "&origin=" + origin;
  };

  create_iframe = function(source, width, height) {
    var iframe, min, normalize, normalize_height, normalize_width;
    min = function(m) {
      return function(v) {
        if (v < m) {
          return m;
        } else {
          return v;
        }
      };
    };
    normalize = function(m, d) {
      return function(v) {
        return min(m)(defaults(d)(v));
      };
    };
    normalize_width = normalize(WIDTH.MIN, WIDTH.DEFAULT);
    normalize_height = normalize(HEIGHT.MIN, HEIGHT.DEFAULT);
    iframe = document.createElement("iframe");
    iframe.setAttribute('src', source);
    iframe.setAttribute('width', normalize_width(width));
    iframe.setAttribute('height', normalize_height(height));
    return iframe;
  };

  attach_element = function(container, element) {
    var target;
    target = getElementById(container);
    return target.appendChild(element);
  };

  configure = function(options) {
    var callback, domain, iframe, path, source;
    domain = domain_for(options.protocol, options.host);
    path = document_path(options.key, options.email);
    source = domain + path;
    iframe = create_iframe(source, options.width, options.height);
    attach_element(options.container, iframe);
    callback = options.callback || function() {};
    return window.addEventListener("message", callback);
  };

  this.clicksign || (this.clicksign = {
    configure: configure
  });

}).call(this);
